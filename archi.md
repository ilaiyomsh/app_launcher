מסמך אפיון מערכת: Twist's Apps

גרסה: 1.0

תאריך: 07/12/2025

סטטוס: טיוטה לאישור

קהל יעד: מפתחים, מנהלי מוצר, צוותי תפעול (Ops)

1. תקציר מנהלים (Executive Summary)

הצוות בארגון משתמש ב-Gemini Canvas ליצירת כלי עזר (Micro-Apps) מבוססי React לשיפור תהליכי העבודה. כיום, קיים פער טכנולוגי בין קבלת הקוד מ-Gemini לבין הטמעתו ככלי חי בתוך מערכת Monday.com.

מטרת הפרויקט: פיתוח פלטפורמת "Launchpad" שתאפשר למשתמשים לא-טכניים להפוך קוד React לקישור (URL) קבוע ופעיל בלחיצת כפתור, אותו ניתן להטמיע ב-Monday. המערכת תכלול גם ממשק ניהול (Admin Panel) לעריכה ותיקון של הכלים לאחר יצירתם, ללא צורך ב-Deployment מחדש.

2. תרשים זרימה וארכיטקטורה (High-Level Architecture)

המערכת תבנויה בארכיטקטורת Serverless המסתמכת על Client-Side Rendering.

זרימת הנתונים (Data Flow):

מקור (Source): המשתמש מייצר קוד React ב-Gemini Canvas.

ממשק יצירה (Creator UI): המשתמש מדביק את הקוד במערכת ומקבל URL ייחודי.

אחסון (Persistence): הקוד נשמר כ-String במסד נתונים (Firebase Firestore).

מנוע ריצה (Runtime Engine): בעת טעינת ה-URL, הדפדפן מושך את הקוד ומריץ אותו באמצעות Sandpack (ללא שרת Build).

הטמעה (Consumption): ה-URL מוטמע בתוך Monday Widget (iframe).

ניהול (Administration): אדמין יכול לערוך את הקוד ב-DB דרך ממשק ייעודי, והשינוי משתקף מיד ב-Monday.

3. פירוט מודולים פונקציונליים

3.1 מודול היצירה ("המשגר") - /create

מיועד לצוות התפעולי. דגש על פשטות ומהירות.

דרישות פונקציונליות:

תיבת טקסט (Input): אזור להדבקת קוד React (תמיכה בקובץ יחיד - App.js).

שדה שם (Name): מתן שם מזהה לכלי (למשל: "מחשבון עמלות מרץ").

ולידציה בסיסית: בדיקה שהקוד אינו ריק.

פעולת שמירה: לחיצה על "צור כלי" שומרת רשומה ב-Firestore.

פלט (Output): הצגת ה-URL שנוצר עם כפתור "העתק ללוח".

מבנה ה-URL: https://app-domain.com/view/{unique_id}.

3.2 מודול הצפייה ("המנוע") - /view/:id

זהו המסך שמוצג בתוך ה-iframe במאנדיי. עליו להיות נקי לחלוטין מסימני מערכת.

דרישות פונקציונליות:

שליפה (Fetching): קבלת ה-ID מה-URL ושליפת הקוד המתאים מ-Firestore.

ריצה (Execution): שימוש ברכיב @codesandbox/sandpack-react.

תצוגה:

הסתרת כל רכיבי העורך (Editor, Tabs, Console).

הגדרת גובה ורוחב ל-100% (Viewport).

תמיכה ב-Tailwind CSS (מוגדר מראש ב-Sandpack).

טיפול בשגיאות: במידה וה-ID לא קיים או הקוד שבור, הצגת הודעה ויזואלית נקייה ("Tool not found" או "Runtime Error") במקום מסך לבן.

3.3 מודול הניהול (CMS) - /admin

מיועד למנהלי המערכת/Tech Leads לתיקון באגים וניהול מלאי הכלים.

דרישות פונקציונליות:

אבטחה: מסך התחברות (Login) פשוט (Email/Pass או Hardcoded secret לגרסה ראשונה).

רשימת כלים (List View):

טבלת כלים הכוללת: שם, ID, תאריך יצירה, תאריך עדכון אחרון.

חיפוש חופשי לפי שם כלי.

עורך קוד (Code Editor):

בלחיצה על כלי מהרשימה, נפתח עורך קוד (monaco-editor או דומה).

העורך יציג את הקוד הנוכחי שנשמר ב-DB.

עדכון חי (Live Update): כפתור "שמור שינויים" שמעדכן את הרשומה ב-Firestore. השינוי חייב להיות מיידי עבור משתמשי הקצה (בטעינה הבאה של הדף).

מחיקה (אופציונלי): אפשרות למחוק כלים שאינם בשימוש (Soft Delete).

4. מודל נתונים (Data Schema) - Firebase Firestore

שם ה-Collection: snippets

שדה

סוג (Type)

תיאור

חובה?

id

String (UUID)

המזהה הייחודי של המסמך (נוצר אוטומטית)

כן

name

String

שם הכלי (לנוחות הניהול)

כן

code

String (Long Text)

קוד ה-React המלא

כן

createdAt

Timestamp

תאריך יצירה

כן

updatedAt

Timestamp

תאריך עדכון אחרון

כן

author

String

שם המשתמש שיצר (אופציונלי)

לא

5. דרישות טכניות (Technical Stack)

Frontend Framework: React 18+ (Vite).

Hosting: Vercel או Netlify (חינמי, תמיכה ב-CI/CD, ביצועים גבוהים לקבצים סטטיים).

Database: Firebase Firestore (NoSQL, Realtime updates capability).

Core Library: @codesandbox/sandpack-react (מנוע הריצה).

Styling: Tailwind CSS (לעיצוב המערכת עצמה).

Icons: Lucide React.

6. דרישות לא פונקציונליות (NFR)

ביצועים: זמן טעינה של ה-Viewer (עד להופעת האפליקציה) לא יעלה על 2-3 שניות ברשת סבירה.

רספונסיביות: ה-Viewer חייב להתאים את עצמו לכל גודל של iframe (רוחב מלא, עמודה צרה בדאשבורד, וכו').

אמינות: המערכת חייבת להיות זמינה 99.9% מהזמן (מסתמך על SLA של Vercel ו-Firebase).

תחזוקה: הקוד צריך להיות מתועד, עם הפרדה ברורה בין הלוגיקה של ה-Admin לבין ה-Viewer.

7. הנחיות UI/UX להטמעה ב-Monday

כדי שהכלים ירגישו "טבעיים" (Native) בתוך מאנדיי:

רקע האפליקציה (בתוך ה-Sandpack) צריך להיות שקוף או תואם לרקע של מאנדיי (#ffffff ל-Light Mode).

יש להימנע משימוש ב-Scrollbars כפולים (של ה-iframe ושל האפליקציה). מומלץ להגדיר overflow: hidden ב-body של ה-Viewer.

יש להנחות את Gemini לא להשתמש ב-Alerts של הדפדפן (window.alert) אלא ברכיבי UI מודרניים, כיוון ש-Alerts עשויים להיחסם בתוך iframe.

8. סיכונים והפחתתם

סיכון

רמת סיכון

הפחתה (Mitigation)

קוד זדוני (XSS)

בינונית

המערכת מריצה קוד שמשתמשים כותבים. מכיוון שזה כלי פנימי, הסיכון נמוך, אך יש להגביל את הגישה ל-/create ו-/admin רק למורשים.

שבירת קוד בייצור

גבוהה

עריכה ב-Admin עלולה לשבור את הכלי לכולם. פתרון עתידי: הוספת "Preview Mode" לפני שמירה.

תלויות חסרות

נמוכה

אם Gemini משתמש בספרייה שלא הוגדרה. יש להגדיר ב-Sandpack תמיכה ב-Imports אוטומטיים או רשימת חבילות נפוצות מוגדרת מראש.